<table class="custom-table">
  <thead>
    <tr>
      <th (click)="sortBy('process_number')">
        <div class="flex">
          <span>Número processo</span>
          <mat-icon class="sortable-icon" [class.active]="sortColumn === 'process_number'">
            {{ sortColumn === 'process_number' ? (sortDirection === 'asc' ? 'arrow_upward' : 'arrow_downward') : 'unfold_more' }}
          </mat-icon>
        </div>
      </th>

      <th (click)="sortBy('applicant_name')">
        <div class="flex">
          <span>Requerente</span>
          <mat-icon class="sortable-icon" [class.active]="sortColumn === 'applicant_name'">
            {{ sortColumn === 'applicant_name' ? (sortDirection === 'asc' ? 'arrow_upward' : 'arrow_downward') : 'unfold_more' }}
          </mat-icon>
        </div>
      </th>

      <th (click)="sortBy('value')">
        <div class="flex">
          <span>Valor</span>
          <mat-icon class="sortable-icon material-icons-outlined" [class.active]="sortColumn === 'value'">
            {{ sortColumn === 'value' ? (sortDirection === 'asc' ? 'arrow_upward' : 'arrow_downward') : 'unfold_more' }}
          </mat-icon>
        </div>
      </th>

      <!-- <th (click)="sortBy('cpf_cnpj')">
        <div class="flex">
          <span>Documento</span>
          <mat-icon class="sortable-icon" [class.active]="sortColumn === 'cpf_cnpj'">
            {{ sortColumn === 'cpf_cnpj' ? (sortDirection === 'asc' ? 'arrow_upward' : 'arrow_downward') : 'unfold_more' }}
          </mat-icon>
        </div>
      </th> -->

      <th (click)="sortBy('company_name')">
        <div class="flex">
          <span>Requerido</span>
          <mat-icon class="sortable-icon" [class.active]="sortColumn === 'company_name'">
            {{ sortColumn === 'company_name' ? (sortDirection === 'asc' ? 'arrow_upward' : 'arrow_downward') : 'unfold_more' }}
          </mat-icon>
        </div>
      </th>

      <th (click)="sortBy('status')">
        <div class="flex">
          <span>Status</span>
          <mat-icon class="sortable-icon" [class.active]="sortColumn === 'status'">
            {{ sortColumn === 'status' ? (sortDirection === 'asc' ? 'arrow_upward' : 'arrow_downward') : 'unfold_more' }}
          </mat-icon>
        </div>
      </th>

      <th (click)="sortBy('data_exporting')">
        <div class="flex">
          <span>Obtido</span>
          <mat-icon class="sortable-icon" [class.active]="sortColumn === 'data_exporting'">
            {{ sortColumn === 'data_exporting' ? (sortDirection === 'asc' ? 'arrow_upward' : 'arrow_downward') : 'unfold_more' }}
          </mat-icon>
        </div>
      </th>

      <th (click)="sortBy('created_at')">
        <div class="flex">
          <span>Disponível</span>
          <mat-icon class="sortable-icon" [class.active]="sortColumn === 'created_at'">
            {{ sortColumn === 'created_at' ? (sortDirection === 'asc' ? 'arrow_upward' : 'arrow_downward') : 'unfold_more' }}
          </mat-icon>
        </div>
      </th>

      <th>
        <span>Ações</span>
      </th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let process of paginatedProcesses; let i = index">
      <td>{{ process.process_number }}</td>
      <td>{{ process.applicant_name || '-' }}</td>
      <td>{{ process.value | currency:'BRL' }}</td>
      <!-- <td>{{ formatDocument(process.cpf_cnpj!) }}</td> -->
      <td>
        <span class="truncate">{{ process.company_name?.length! > 20 ? (process.company_name | slice:0:30) + '...' : process.company_name || '-'}}</span>
      </td>
      
      <td>
        <mat-form-field appearance="fill">
          <mat-select [(ngModel)]="process.status">
            <mat-option *ngFor="let permission of permissions" [value]="permission"
              (click)="postNewStatus(permission, process.process_number)">
              {{ permission }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </td>
      <td><span class="format-date">{{ process.data_exporting ? getFormatDateToLabel(process.data_exporting) : '-' }}</span></td>
      <td><span class="format-date">{{ process.created_at ? getFormatDateToLabel(process.created_at) : '-' }}</span></td>
      <td><a class="see-more" (click)="onSeeMore(i)">Ver mais</a></td>
    </tr>
  </tbody>
</table>

<!-- Paginação customizada -->
<div class="pagination">
  <button (click)="changePage(1)" [disabled]="currentPage === 1">Primeiro</button>

  <button *ngFor="let page of totalPagesArray"
          [class.active]="page === currentPage"
          (click)="changePage(page)">
    {{ page }}
  </button>

  <button (click)="changePage(totalPages)" [disabled]="currentPage === totalPages">Último</button>
</div>

